<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>People - Anomuge</title>
    <link rel="stylesheet" href="../style.css">
    <meta name="theme-color" content="#000000">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

    <meta name="description" content="Kirimi mereka pesan anonim">
    <link rel="apple-touch-icon" sizes="180x180" href="../assets/icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../assets/icon.png">
    <meta property="og:title" content="Anomuge - People">
    <meta property="og:description" content="Kirimi mereka pesan anonim">
    <meta property="og:image" content="../assets/icon.png">
    <link rel="manifest" href="../manifest.json">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@600;700&display=swap');

        * {
            font-family: Arial, Helvetica, sans-serif;
        }

        /* chrome */
        ::-webkit-scrollbar {
            width: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background-color: #2f2f2f;
        }

        ::-webkit-scrollbar-track {
            background-color: transparent;
        }

        /* Firefox & Edge */

        * {
            scrollbar-color: #2f2f2f transparent;
            /* Warna thumb dan track */
        }

        ::selection {
            background-color: #5f5f5f;
        }

        .paragraph {
            color: #afafaf;
        }






        #pc-navb,
        #mobile-navb {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 53px;
            font-size: 15px;
            justify-content: space-between;
            border-bottom: 0.5px solid rgb(47, 51, 54);
            align-items: center;
            padding: 0 25px 0 16px;
            background-color: black;
            user-select: none;
            z-index: 5;
            color: #E7E9EA;
            will-change: transform;
        }

        #loading {
            display: block;
            height: 92vh;
        }

        #mobile-footer {
            display: none;
            user-select: none;
        }


        .post-button {
            user-select: none !important;
            font-weight: 600;
            font-family: Arial, Helvetica, sans-serif;
        }

        .post-button:active {
            background-color: #0d6cab;
        }

        .bwhite {
            background-color: white;
        }

        .white {
            color: #E7E9EA;
        }

        .blue {
            color: #1D9BF0;
        }

        .bblue {
            background-color: #1D9BF0;
        }

        .hideData {
            display: none;
        }

        .announcement-container {
            padding: 0.1px;
            height: 25px;
        }

        .announcement {
            font-size: 14px;
            background-color: #1D9BF0;
            border-radius: 6px 0;
            padding: 2px;
            font-family: Arial, Helvetica, sans-serif;
            font-weight: 520;
        }

        .title {
            font-size: 23px;
            font-family: Poppins, Arial, Helvetica, sans-serif;
        }

        .ic-click:hover {
            background-color: rgb(61, 61, 61);
        }

        .ic-click {
            font-size: 24px;
            cursor: pointer;
            padding: 8px 9px;
            background-color: transparent;
            border-radius: 70%;
        }

        .ic-click:active {
            background-color: rgb(61, 61, 61);
        }

        #empty-data {
            margin-top: 12%;
        }

        .rounded-default {
            border-radius: 6px;
        }

        .desc {
            max-width: 350px;
        }

        .t-inf {
            font-size: 19px;

        }


        @media only screen and (max-width: 765px) {

            body {
                overflow: hidden;
            }

            #main {
                min-height: 90vh;
                overflow: hidden;
                /*Firefox */
                scrollbar-width: thin;
                scrollbar-color: transparent transparent;

            }


            /* Chrome dan Safari */
            #main::-webkit-scrollbar {
                width: 0;
            }

            /* Firefox */
            #main::-moz-scrollbar {
                display: none;
            }

            #sidebar {
                display: none;
            }

            #data-container {
                justify-content: center;
                padding-bottom: 60px;
            }

            #mobile-footer {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                display: flex;
                height: 59px;
                background-color: black;
                will-change: transform;
                padding: 0 8%;
                border-top: 0.5px solid rgb(47, 51, 54);
            }

            .button-list {
                justify-content: space-between;
                align-items: center;
                display: flex;
                width: 100%;
            }

            .mobile-page-button {
                color: #b5b5b5;
                display: grid;
                place-items: center;
                cursor: unset;
                height: 100%;
                padding: 13.5px 7px;
            }

            .mobile-page-icon {
                font-size: 19px;
            }

            .mobile-page-name {
                font-size: 11px;
                margin-top: 3px;
            }

            .mobile-is-here {
                color: #E7E9EA;
            }

            .card {
                width: 160px;
                background-color: #2a2a31;
                box-sizing: content-box;
                margin: 10px;
                border-radius: 6px;
                cursor: unset;
                user-select: none;
            }

            .end {
                .card {
                    width: 160px;
                    background-color: transparent;
                    height: 160px;
                    box-sizing: content-box;
                    margin: 10px;
                    border-radius: 6px;
                    cursor: unset;
                    user-select: none;
                }
            }


            .card:active {
                background-color: #212127;
            }

            .card-icon {
                font-size: 40px;
                color: #E7E9EA;
            }


            #navb {
                padding: 2em 14px;
            }

            .ic-click {
                cursor: unset !important;
            }

            .post-button {
                user-select: none !important;
                font-weight: 600;
                font-family: Arial, Helvetica, sans-serif;
                cursor: unset !important;
            }

            .ic-click:hover {
                background-color: transparent;
            }

            .ic-click:active {
                background-color: rgb(61, 61, 61);
            }

            #pc-navb {
                display: none;
            }

            #mobile-navb {
                padding: 2em 14px;
                display: flex;
            }

            .verification {
                background-color: #1D9BF0;
                padding: 3.5px;
                font-size: 10px;
                margin: 0 6px;
                color: black;
                border-radius: 50%;
            }



            .user-container {
                width: 100vw;
                padding: 17px 19px;
                background-color: transparent;
                display: flex;
                align-items: center;
                user-select: none;
                cursor: unset;
                overflow-wrap: break-word;
                word-break: break-word;
                white-space: normal;
                border-bottom: 0.5px solid rgb(47, 51, 54);
            }

            .user-container:active {
                background-color: rgb(33, 33, 33);
            }

            .showData {
                display: block;
            }

            .username {
                color: #E7E9EA;
                font-size: 19px;
                font-family: Arial, Helvetica, sans-serif;
                font-weight: 550;
            }

            .bio {
                color: #96999a;
                font-size: 17px;
                font-family: Arial, Helvetica, sans-serif;
                margin-top: 5px;
            }


            @keyframes rotate {
                from {
                    transform: rotate(0deg);
                }

                to {
                    transform: rotate(360deg);
                }
            }


            @-webkit-keyframes rotate {
                from {
                    -webkit-transform: rotate(0deg);
                }

                to {
                    -webkit-transform: rotate(360deg);
                }
            }

            .loading {
                width: 50px;
                height: 50px;
                border: solid 5px #E7E9EA;
                border-radius: 50%;
                border-right-color: transparent;
                border-bottom-color: transparent;
                -webkit-transition: all 0.5s ease-in;
                -webkit-animation-name: rotate;
                -webkit-animation-duration: 1.0s;
                -webkit-animation-iteration-count: infinite;
                -webkit-animation-timing-function: linear;

                transition: all 0.5s ease-in;
                animation-name: rotate;
                animation-duration: 1.0s;
                animation-iteration-count: infinite;
                animation-timing-function: linear;
            }



        }

        @media only screen and (min-width: 765px) {

            body {
                display: flex;
                overflow: hidden;

            }

            #main {
                overflow: auto;
                height: 100vh;
            }

            #mobile-navb {
                display: none;
            }

            #pc-navb {
                display: flex;
                padding-left: 23px;
            }

            #mobile-footer {
                display: none;
            }

            .verification {
                background-color: #1D9BF0;
                padding: 3.5px;
                font-size: 9.7px;
                margin: 1px 6px 0 6px;
                color: black;
                border-radius: 50%;
            }





            #main {
                overflow: auto;
                scrollbar-width: thin;
                width: 100%;

            }

            .showData {
                display: grid;
                place-items: center;
            }

            #data-container {
                padding: 20px;
            }

            .card {
                width: 170px;
                background-color: #2a2a31;
                box-sizing: content-box;
                margin: 10px;
                border-radius: 6px;
                cursor: pointer;
                transition: transform 0.2s ease-in-out;
                user-select: none;
            }

            .card:hover {
                transform: scale(1.1);
            }

            .card:active {
                background-color: #212127;
            }

            .card-icon {
                font-size: 40px;
                color: #E7E9EA;
            }

            .end {
                width: 170px;
                height: 170px;
                background-color: transparent;
                box-sizing: content-box;
                margin: 10px;
                border-radius: 6px;
                cursor: pointer;
                transition: transform 0.2s ease-in-out;
                user-select: none;
            }

            .user-container {
                display: flex;
                padding: 15px 20px;
                background-color: #2a2a31;
                width: 65%;
                border-radius: 6px;
                user-select: none;
                cursor: pointer;
                overflow-wrap: break-word;
                word-break: break-word;
                white-space: normal;
                margin: 5px 0;
            }

            .user-container:hover {
                background-color: #222228;
            }

            .username {
                color: #E7E9EA;
                font-size: 19px;
                font-family: Arial, Helvetica, sans-serif;
                font-weight: 550;

            }

            .bio {
                color: #96999a;
                font-size: 17px;
                font-family: Arial, Helvetica, sans-serif;
                margin-top: 3px;
            }




            #sidebar {
                width: 17vw;
                height: 100vh;
                background-color: rgb(0, 0, 0);
                z-index: 1;
                border-right: 1px solid rgb(47, 51, 54);
                overflow-y: auto;
                padding-top: 81px;
                user-select: none;
            }


            #main {
                overflow: auto;
                scrollbar-width: thin;
                width: 100%;
                padding-top: 75px;

            }

            .page-button {
                padding: 10px 13px;
                margin: 7px 12px;
                font-family: Arial, Helvetica, sans-serif;
                font-weight: 570;
                display: flex;
                align-items: center;
                font-size: 20px;
                cursor: pointer;
            }

            .is-here {
                background-color: #2a2a31;
                border-radius: 9px;
            }

            .page-button:hover {
                background-color: #1c1c20;
                border-radius: 9px;
            }

            .is-here:hover {
                background-color: #2a2a31;
            }

            .page-icon {
                font-size: 23px;
            }

            .page-name {
                margin-left: 20px;
            }

            #page-button-container {
                border-bottom: 0.2px solid rgb(47, 51, 54);
                padding: 0 0 10px 0;
            }

            #copyright {
                color: #717171;
                text-align: center;
                margin: 17px 0;
                font-size: 14px;
            }



            .post-button:hover {
                background-color: #0d6cab;
            }



            @keyframes rotate {
                from {
                    transform: rotate(0deg);
                }

                to {
                    transform: rotate(360deg);
                }
            }


            @-webkit-keyframes rotate {
                from {
                    -webkit-transform: rotate(0deg);
                }

                to {
                    -webkit-transform: rotate(360deg);
                }
            }



            .loading {
                width: 60px;
                height: 60px;
                border: solid 7px #E7E9EA;
                border-radius: 50%;
                border-right-color: transparent;
                border-bottom-color: transparent;
                -webkit-transition: all 0.5s ease-in;
                -webkit-animation-name: rotate;
                -webkit-animation-duration: 1.0s;
                -webkit-animation-iteration-count: infinite;
                -webkit-animation-timing-function: linear;

                transition: all 0.5s ease-in;
                animation-name: rotate;
                animation-duration: 1.0s;
                animation-iteration-count: infinite;
                animation-timing-function: linear;
            }
        }

        /* max width 1210 */
        @media screen and (max-width: 1210px) {
            #main {
                padding-top: 75px;
            }

            #sidebar {
                width: 77px;
            }

            #copyright {
                display: none;
            }

            .page-name {
                display: none;
            }

            .page-button {
                text-align: center;
                display: flex;
                justify-content: center;
            }
        }

        @media screen and (min-width: 1210px) {
            .page-icon {
                width: 29px;
            }
        }


        @media screen and (max-width: 360px) {
            .card {
                width: 140px;
            }
        }

        @media screen and (max-width: 326px) {
            .card {
                width: 90%;
            }
        }
    </style>
</head>

<body class="bg-black">
    <section id="sidebar">
        <ul id="page-button-container">
            <li>
                <a href="../" class="page-button flex white" oncontextmenu="return false;">
                    <i class="page-icon fas fa-home"></i>
                    <p class="page-name">Beranda</p>
                </a>
            </li>
            <li>
                <a href="../post" class="page-button flex white" oncontextmenu="return false;">
                    <i class="page-icon fas fa-pencil-alt"></i>
                    <p class="page-name">Posting</p>
                </a>
            </li>
            <li>
                <div onclick="window.location.href = `../profile/?n=@${decrypt(localStorage.getItem('rk_4t9'),71)}`"
                    class="page-button flex white" oncontextmenu="return false;">
                    <i class="page-icon fas fa-user"></i>
                    <p class="page-name">Profil</p>
                </div>
            </li>
            <li>
                <a href="./followed" class="page-button flex white" oncontextmenu="return false;">
                    <i class="page-icon fas fa-circle-notch fa-spin"></i>
                    <p class="page-name">Status</p>
                </a>
            </li>
            <li>
                <a href="../messages" class="page-button flex white" oncontextmenu="return false;">
                    <i class="page-icon fas fa-comment"></i>
                    <p class="page-name">Pesan</p>
                </a>
            </li>
            <li>
                <a href="../about" class="page-button flex white" oncontextmenu="return false;">
                    <i class="page-icon fas fa-info-circle"></i>
                    <p class="page-name">Tentang</p>
                </a>
            </li>
        </ul>
        <p id="copyright"></p>
    </section>

    <section id="main">
        <nav id="pc-navb" class="bg-black">
            <span>
                <h1 class="title white font-bold">Anomuge</h1>
            </span>
        </nav>
        <nav id="mobile-navb" class="bg-black">
            <span class="flex">

                <h1 style="margin-left: 5px;" id="sender-name" class="font-bold text-xl">Orang</h1>
            </span>
        </nav>
        <section id="data-container" class="hideData">

        </section>
        <section id="loading">
            <div style="display: flex; justify-content: center; align-items: center; height: 80%; width: 100%;"
                class="loading-container">
                <div class="loading"></div>
            </div>
        </section>
        <section style="display: none;" id="empty-data" class="flex justify-center items-center select-none">
            <div class="inf inline-block text-center">
                <p class="paragraph desc m-5">Tidak ada user</p>
            </div>

        </section>
    </section>
    <footer id="mobile-footer">
        <ul class="button-list">
            <li onclick="window.location.href = '../'" class="mobile-page-button">
                <i class="mobile-page-icon fas fa-home"></i>
                <p class="mobile-page-name">Beranda</p>
            </li>
            <li onclick="window.location.href = '../followed'" class="mobile-page-button mobile-is-here">
                <i class="mobile-page-icon fas fa-circle-notch fa-spin"></i>
                <p class="mobile-page-name">Status</p>
            </li>
            <li onclick="window.location.href = '../messages'" class="mobile-page-button">
                <i class="mobile-page-icon fas fa-comment"></i>
                <p class="mobile-page-name">Pesan</p>
            </li>
            <li onclick="window.location.href = `../profile/?n=@${decrypt(localStorage.getItem('rk_4t9'),71)}`"
                class="mobile-page-button">
                <i class="mobile-page-icon fas fa-user"></i>
                <p class="mobile-page-name">Profil</p>
            </li>
        </ul>
    </footer>

    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('../sw.js')
                .then((reg) => {
                    console.log(reg.scope);
                })
                .catch((error) => {
                    console.error(error);
                });
        }
    </script>

    <script>document.querySelector('html').setAttribute('lang', navigator.language || navigator.userLanguage);</script>


    <script type="text/javascript">
        const emptyData = document.getElementById("empty-data");
        const dataContainer = document.getElementById("data-container");
        const loading_section = document.getElementById("loading");
        const copyright = document.getElementById("copyright");
        copyright.innerText = `Â© ${new Date().getFullYear()} Wahyuna`;

        if (window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone) {
            document.body.style.userSelect = "none";
        }



        const chrt = (char, key) => /[a-zA-Z]/.test(char) ? String.fromCharCode((char.charCodeAt() - (/[A-Z]/.test(char) ? 65 : 97) + key + 26) % 26 + (/[A-Z]/.test(char) ? 65 : 97)) : char;
        const text_to_base64 = (text) => btoa(text);
        const base64_to_text = (base64) => atob(base64);
        const encrypt = (text, key) => text_to_base64([...text].map(char => chrt(char, key)).join(''));
        const decrypt = (text, key) => [...base64_to_text(text)].map(char => chrt(char, (26 - key) % 26)).join('');

        function user(name_data, verification_data, bio_data) {
            const userContainer = document.createElement("div");
            userContainer.setAttribute("class", "user-container")
            userContainer.addEventListener("click", function () {
                window.location.href = "../profile/?n=" + name_data
            })

            const usernameContainer = document.createElement("div");
            usernameContainer.style.display = "block";
            const usernameCtr = document.createElement("div");
            usernameCtr.style.display = "flex";
            usernameCtr.style.alignItems = "center";
            const username = document.createElement("p");
            username.setAttribute("class", "username")
            username.innerText = name_data.trim()

            const verification = document.createElement('i')
            verification.setAttribute("class", "verification fas fa-check")


            usernameCtr.appendChild(username)
            if (verification_data) {
                usernameCtr.appendChild(verification)
            }
            usernameContainer.appendChild(usernameCtr);

            const bio = document.createElement('p')
            bio.setAttribute("class", "bio")
            bio.innerText = bio_data.trim()
            usernameContainer.appendChild(bio)
            userContainer.appendChild(usernameContainer);

            dataContainer.appendChild(userContainer)
        }

        if (localStorage.getItem("_0_n")) {
            let xhr = new XMLHttpRequest();
            xhr.open('POST', '../check.php', true);
            xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');

            xhr.onreadystatechange = function () {
                if (xhr.readyState == 4 && xhr.status == 200) {
                    let output = JSON.parse(xhr.responseText);

                    if (output.success) {
                        fetch('../people_be.php')
                            .then(res => res.json())
                            .then(data => {
                                if (data.length > 0) {

                                    setTimeout(function () {
                                        emptyData.style.display = "none";
                                        document.body.style.overflow = 'auto';
                                        loading_section.style.display = "none";
                                        dataContainer.setAttribute("class", "showData");
                                    }, 50);

                                    data.forEach(person => {
                                        if (person.id !== output.id) {
                                            const decryptedUsername = decrypt(person.username, 71);
                                            user(decryptedUsername, person.verification, person.bio);
                                        }
                                    });
                                } else {
                                    setTimeout(function () {
                                        dataContainer.setAttribute("class", "hideData");
                                        document.body.style.overflow = 'auto';
                                        loading_section.style.display = "none";
                                        emptyData.style.display = "flex";
                                    }, 50);
                                }
                            })
                            .catch(error => {
                                console.error(error);
                            });


                    } else {
                        // akun salah
                        window.location.replace("../signin");
                    }
                }
            };

            // Kirim data ke server
            xhr.send('token=' + encodeURIComponent(localStorage.getItem("_0_n")));
        } else {
            window.location.replace("../signin");
        }
        
    </script>
</body>

</html>